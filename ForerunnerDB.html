<!DOCTYPE>
<html>
  <head>
    <link rel="stylesheet" href="css/bootstrap.css">
    <script src="fdb-all.min.js"></script>  
    <script src="js/jquery-1.12.2.min.js"></script>  
    <script src="js/bootstrap.js"></script> 
    <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
      <div class="container">
        <input type="text" class='find-input'>
        <button type='button' class='btn btn-primary btn-lg find-button'>find</button>
        <br>
        <input type="checkbox" class="a-class"/>
        甲班
        <input type="checkbox" class="b-class"/>
        乙班
        <input type="checkbox" class="c-class"/>
        丙班
        <br>
      </div>
    </nav>
  </head>  
  <body>
  <table class="table">
        <thead>
            <tr>
                <br>
                <br>
                <br>
                <td>name</td>
                <td>age</td>
                <td>id</td>
                <td>操作</td>
            </tr>
        </thead>
        <tbody>

        </tbody>
    </table>
    <script>
      var fdb = new ForerunnerDB();
      var db = fdb.db("my_db");
      var studentCollection = db.collection('students');
      var studentCollection = db.collection('parents');
      var studentCollection = db.collection('teachers');
      studentCollection.load(function(){
        var studentName =["Eugene","Kevin","Arthur","Aaron","Evan","Eunice","Wendy","Candy","Tom","Annie"];
        var newStudent = {
          name: studentName[Math.floor((Math.random() * 9) + 0)],
          age:  Math.floor((Math.random() * 30) + 1)
          };
        studentCollection.insert(newStudent);			
        studentCollection.save() 
        refresh()
      });
      $("body").on("click",".delete-button",function(){
        studentCollection.remove({  
          _id:$(this).data("id")
        });
        studentCollection.save();
        refresh();
      })
      $("body").on("click",".edit-button",function(){
        var id = $(this).data("id");
        var result = studentCollection.find( {_id: id} )[0];
        $(".name").val(result['name']);
        $(".age").val(result['age']);
        // studentCollection.save();
        // refresh();
      })
        $("body").on("click",".find-button",function(){
        	var fdb = new ForerunnerDB();
      		var db = fdb.db("my_db");
      		var studentCollection = db.collection('students');
      		studentCollection.load(function(){
        	  var studentName =["Eugene","Kevin","Arthur","Aaron","Evan","Eunice","Wendy","Candy","Tom","Annie"];
            refresh();
          });
        });
        $("body").on("click","checkbox",function(){
          var findclass = [];
          $(".a-class").prop( "checked" )
          $(".b-class").prop( "checked" )
          $(".c-class").prop( "checked" )
        })
      function refresh(){
        $("tbody *").remove();
          var students = studentCollection.find({
            age: {
              $gte:$(".find-input").val()
            }
          });
          for(var i=0;i<students.length;i++){
{            $("tbody").append(
              "<tr>"+
              "<td id ='name"+i+"'>"+students[i].name+"</td>"+  
              "<td id ='age"+i+"'>"+students[i].age+"</td>"+
              "<td id ='id"+i+"'>"+students[i]._id+"</td>"+
              "<td>"+
              "<button type='button' class='btn btn-primary btn-lg edit-button' data-toggle='modal' data-target='#myModalN1' data-id='"+students[i]._id+"'>"+
              "修改"+
              "</button>"+
              "<button type='button' class='btn btn-primary btn-lg delete-button' data-id='"+students[i]._id+"'>"+
              "刪除"+
              "</button>"+
              "</td>"+
              "</tr>"
            )
          }
        }
      }
    </script>
    <!-- Modal 1 -->
    <div class="modal fade" id="myModalN1" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
      <div class="modal-dialog" role="document">
       <div class="modal-content">
          <div class="modal-header">
           <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
           <h4 class="modal-title" id="myModalLabel">Modal title</h4>
          </div>
          <div class="modal-body">
            Name:
            <input type="text" class="name"/>
            <br>
            <br>
            age:
            <input type="text" class="age"/>
            <br>
            <br>
            parent:
            <select id="parent-id">
             <option value="">請選擇家長</option>
              <option value="1beda312sd">Orange</option>
              <option value="5b23fs45hj">Apple</option>
            </select>
            <br>
            <br>
            teacher:
            <select id="parent-id">
             <option value="">請選擇老師</option>
              <option value="1beda312sd">Orange</option>
              <option value="5b23fs45hj">Apple</option>
            </select>
          </div>
          <div class="modal-footer"> 
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            <button type="button" class="btn btn-primary">Save changes</button>
          </div>
        </div>
      </div>
      
    </div>
  </body>  
</html>  
